<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">

<link rel="stylesheet"
      href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.4.1/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.4.1/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<style>
textarea {
	height:150px;
	width:100%;
}
</style>
<script>
'use strict';

document.addEventListener('keydown', (e)=> {
	const ke = document.querySelector('#keyboard-eve');
	const event_name = e.__proto__.toString().match(/[a-z-A-Z]+/g)[1];
	ke.querySelector('li>span').textContent = event_name;
	ke.querySelector('li+li>span').textContent = e.code;
	ke.querySelector('li+li+li>span').textContent = e.key;
})

const test = (self) => {
	try {
		const result = Function(
			'"use strict"; return (' 
			+ self.value
			+ ')'
		)();
		console.log(result);
		document.querySelector('#result>p').textContent = result;
		document.querySelector('#yourcode').textContent = self.value;
		hljs.highlightBlock(document.querySelector('#yourcode'));
	} catch(e) {	
		document.querySelector('#result>p').textContent = "";
	}
}
window.onload = () => {
	document.querySelector('#code>textarea').dispatchEvent(
		new Event('input')
	)
}
</script>
</head>
<body>
<form id="code">
	<h2>▼ JavaScriptのコードを試し書きできます</h2>
	<textarea oninput="test(this)">
(() => {

  var stateObj = { key1: "val1" };
  history.replaceState(stateObj, "title", "dummy");
  return JSON.stringify(history.state)

})()</textarea>
	<pre><code class="javascript" id="yourcode">
	</code></pre>
</form>
<div id="result">
	<h2>コードの実行結果</h2>
	<p></p>
</div>
<div id="keyboard-eve">
	<h2>発生したキーボードイベント</h2>
	<ul>
		<li>イベントのプロトタイプ名: <span></span> </li>
		<li>codeプロパティ: <span></span></li>
		<li>keyプロパティ: <span></span></li>
	</ul>
</div>

<div id="test-form">
	<h2>test用フォーム</h2>
	<form id="hoge" name="h">
		<input name="i">
	</form>

	<form id="fuge" name="f">
		<input name="i">
	</form>

	<form id="sage" name="s">
		<input name="i">
	</form>
</div>
</body>
</html>

