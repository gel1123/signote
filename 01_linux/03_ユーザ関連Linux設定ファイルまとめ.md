# Linuxのユーザ・グループ管理用の設定ファイルについて

## ユーザ関連

### /etc/passwd
ユーザのIDやホームディレクトリ、ログインシェルなどが書かれているのが/etc/passwdです。コロンを区切り文字として、1行ごとにユーザの情報が記されています。

```bash
# test01ユーザについて、/etc/passwd内の記述を確認
cat /etc/passwd | grep test01

# /etc/passwdの内容は以下：
# test01:x:1001:1001:test01@hogemail.com:/home/test01:/bin/bash
```

|列番号|意味|上記「test01」ユーザの値|
|----|----|----|
|1|ユーザ名|test01|
|2|パスワード。設定済みなら"x"が表示|x|
|3|ユーザID|1001|
|4|グループID|1001|
|5|コメント|test01@hogemail.com|
|6|ホームディレクトリ|/home/test01|
|7|ログインシェル|/bin/bash|


### /etc/shadow
ハッシュ化されたパスワードや、パスワードの有効期限などの情報が記されています。

```bash
# test01ユーザについて、/etc/shadow内の記述を確認
sudo cat /etc/shadow | grep test01

# /etc/shadowの内容は以下：
test01:$6$kXBRGbQK$Mqs10ikLCAfyvHecyz3XSGoWhAADXh2SNBncfhh4dXvNwoemRZR6xhR9iAJYL5x8Njxgp.mfTddlEQyt7tjpv.:18573:0:99999:7:::
```

|列番号|意味|上記「test01」ユーザの値|
|----|----|----|
|1|ユーザ名|test01|
|2|ハッシュ化されたパスワード|$6$k...(略)|
|3|1970年1月1日から最後にパスワードが変更された日までの日数|18573|
|4|パスワードが変更可能になるまでの日数|0|
|5|パスワード変更期日までの日数|99999|
|6|パスワード変更期日が迫っているのを事前に知らせる日数|7|
|7|パスワードの期限が切れたアカウントが使用不能となるまでの日数||
|8|1970年1月1日からパスワードの有効期限までの日数||
|9|未使用の予約フィールド||

## グループ関連

### /etc/group
/etc/groupには、グループアカウントの情報が左からコロン区切りで以下のように記されています。

|番号|意味|
|----|----|
|1|グループ名|
|2|パスワード|
|3|グループID|
|4|ユーザリスト|

注意が必要なのは上記の『４』です。ユーザリストには『そのグループをセカンダリグループとして登録しているユーザ』のみが記されています。

プライマリグループとしてそのグループに登録しているユーザは、表示されないのです。

たとえば以下のようなユーザがいるとします

* ユーザ名：daemon
* プライマリグループ：daemon
* セカンダリグループ：bin

```bash
groups daemon

# 実行結果：
# daemon : daemon bin
```

このとき/etc/groupを『daemon』で検索すると、以下のような結果が得られます。

```bash
cat /etc/group | grep daemon

# 実行結果：
# bin:x:1:daemon
# daemon:x:2:
```

daemonユーザのプライマリグループである『daemon』には4番目のフィールドが表示されていませんが、daemonユーザのセカンダリグループである『bin』には4番目のフィールドが表示されていますね。

このように/etc/groupの４番めのフィールドには、そのグループをセカンダリグループとして登録しているユーザのみが表示されることに気をつけてください。
